<div class="max-w-4xl mx-auto">
  <div class="mb-8">
    <h1 class="text-2xl font-bold text-white mb-2">Configuración</h1>
    <p class="text-slate-400">Gestiona las integraciones y preferencias del CRM.</p>
  </div>

  <!-- Integrations Card -->
  <div class="bg-surface-dark rounded-xl border border-slate-700/50 overflow-hidden">
    <div class="p-6 border-b border-slate-700/50">
      <h2 class="text-lg font-bold text-white flex items-center gap-2">
        <span class="material-symbols-outlined text-primary">extension</span>
        Integraciones
      </h2>
    </div>

    <div class="divide-y divide-slate-700/50">
      <!-- Meta / Facebook Lead Ads -->
      <div class="p-6 flex items-start justify-between">
        <div class="flex gap-4">
          <div class="w-12 h-12 rounded-lg bg-[#1877F2]/10 flex items-center justify-center text-[#1877F2]">
            <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
          </div>
          <div>
            <h3 class="text-white font-medium text-base">Facebook Lead Ads</h3>
            <p class="text-slate-400 text-sm mt-1">Sincroniza leads y creativos automáticamente.</p>

            <% if @meta_connection %>
              <div class="mt-3 flex items-center gap-2">
                <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400 border border-emerald-500/20">
                  <span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>
                  Conectado: <%= @meta_connection.page_name %>
                </span>
              </div>
            <% end %>
          </div>
        </div>

        <div>
          <% if @meta_connection %>
            <%= button_to disconnect_meta_admin_settings_path, method: :delete, class: "px-4 py-2 text-sm font-medium text-red-400 hover:bg-red-900/20 rounded-lg transition-colors border border-transparent hover:border-red-900/30" do %>
              Desconectar
            <% end %>
          <% else %>
            <%
              # Construct OAuth URL manually for simplicity or use a helper
              app_id = Rails.application.credentials.dig(:meta, :app_id)
              redirect_uri = auth_meta_callback_url
              scope = "leads_retrieval,pages_manage_metadata,pages_read_engagement,ads_management,pages_show_list,business_management"
              oauth_url = "https://www.facebook.com/v19.0/dialog/oauth?client_id=#{app_id}&redirect_uri=#{redirect_uri}&scope=#{scope}&response_type=code"
            %>
            <a href="<%= oauth_url %>" class="flex items-center gap-2 px-4 py-2 bg-[#1877F2] hover:bg-[#1877F2]/90 text-white text-sm font-bold rounded-lg transition-colors shadow-lg shadow-blue-900/20">
              Conectar Página
            </a>
          <% end %>
        </div>
      </div>

      <!-- Chatwoot (Placeholder status) -->
      <div class="p-6 flex items-start justify-between bg-slate-800/30">
        <div class="flex gap-4">
          <div class="w-12 h-12 rounded-lg bg-indigo-500/10 flex items-center justify-center text-indigo-400">
            <span class="material-symbols-outlined text-2xl">chat</span>
          </div>
          <div>
            <h3 class="text-white font-medium text-base">Chatwoot</h3>
            <p class="text-slate-400 text-sm mt-1">CRM de conversaciones conectado.</p>
             <div class="mt-3 flex items-center gap-2">
                <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400 border border-emerald-500/20">
                  <span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>
                  Activo
                </span>
              </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
